<Page
    x:Name="pageRoot"
    x:Class="AwfulMetro.Views.ReplyView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:AwfulMetro.Views"
    xmlns:common="using:AwfulMetro.Common"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:tools="using:AwfulMetro.Core.Tools"
    xmlns:viewModels="using:AwfulMetro.ViewModels"
    mc:Ignorable="d">
    <Page.DataContext>
        <viewModels:ReplyViewModel />
    </Page.DataContext>
    <Page.Resources>
        <!-- TODO: Delete this line if the key AppName is declared in App.xaml -->
        <x:String x:Key="AppName">My Application</x:String>
        <CollectionViewSource
            x:Name="itemsViewSource"
            Source="{Binding PopularThreads}" />
        <CollectionViewSource
            x:Name="groupedItemsViewSource"
            Source="{Binding SmilieCategoryList}"
            IsSourceGrouped="true"
            ItemsPath="List" />
    
    </Page.Resources>

    <!--
        This grid acts as a root panel for the page that defines two rows:
        * Row 0 contains the back button and page title
        * Row 1 contains the rest of the page layout
    -->
    <Grid Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
        <Grid.ChildrenTransitions>
            <TransitionCollection>
                <EntranceThemeTransition />
            </TransitionCollection>
        </Grid.ChildrenTransitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="70" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Back button and page title -->
        <Grid RequestedTheme="Dark" Background="{StaticResource AwfulBlue}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="120" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Button x:Name="backButton"
                    Command="{Binding NavigationHelper.GoBackCommand, ElementName=pageRoot}"
                    Style="{StaticResource NavigationBackButtonNormalStyle}"
                    VerticalAlignment="Center"
                    HorizontalAlignment="Center"
                    AutomationProperties.Name="Back"
                    AutomationProperties.AutomationId="BackButton"
                    AutomationProperties.ItemType="Navigation Button" />
            <TextBlock x:Name="pageTitle" Text="Reply" Style="{StaticResource HeaderTextBlockStyle}" Grid.Column="1"
                       IsHitTestVisible="false" TextWrapping="NoWrap" VerticalAlignment="Center" />
        </Grid>
        <Grid Grid.Row="1" Margin="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="100"/>
            </Grid.ColumnDefinitions>
            <Grid Grid.Column="0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <TextBox IsSpellCheckEnabled="True" AcceptsReturn="True" Grid.Row="0"
                             HorizontalAlignment="Stretch" Margin="15" x:Name="ReplyText" TextWrapping="Wrap" />
                <WebView x:Name="PreviewLastPostWebView"  Grid.Row="1" Margin="15" />
                <Grid x:Name="ItemGridViewContainer" Visibility="Collapsed" Grid.Row="1">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <SearchBox x:Name="FilterBox" Margin="15" Width="300" PlaceholderText="Filter..." SuggestionsRequested="FilterBox_OnSuggestionsRequested" QuerySubmitted="FilterBox_OnQuerySubmitted" QueryChanged="FilterBox_OnQueryChanged" HorizontalAlignment="Right" Grid.Row="0"/>
                    <GridView
                x:Name="ItemGridView"
                Margin="15"
                ItemClick="itemGridView_ItemClick"
                AutomationProperties.AutomationId="ItemGridView"
                AutomationProperties.Name="Grouped Items"
                Grid.Row="1"
                Padding="0,0,0,0"
                ItemsSource="{Binding Source={StaticResource groupedItemsViewSource}}"
                SelectionMode="None"
                IsSwipeEnabled="false"
                IsItemClickEnabled="True"
                HorizontalAlignment="Left">
                        <GridView.ItemTemplate>
                            <DataTemplate>
                                <Grid HorizontalAlignment="Left" Width="125" Height="125">
                                    <StackPanel VerticalAlignment="Bottom" Background="#FFF0F0F0">
                                        <Border Height="50" Background="#FF415B64">
                                            <Image Source="{Binding ImageUrl}" Stretch="None"
                                           AutomationProperties.Name="{Binding Title}" />
                                        </Border>
                                        <TextBlock Text="{Binding Title}" Foreground="Black"
                                           Style="{StaticResource TitleTextBlockStyle}" Height="60" Margin="15,0,15,0" />
                                    </StackPanel>
                                </Grid>
                            </DataTemplate>
                        </GridView.ItemTemplate>
                        <GridView.GroupStyle>
                            <GroupStyle>
                                <GroupStyle.HeaderTemplate>
                                    <DataTemplate>
                                        <Grid Margin="1,0,0,6">
                                            <Button Foreground="{StaticResource ApplicationHeaderForegroundThemeBrush}"
                                            AutomationProperties.Name="Group Title"
                                            Style="{StaticResource TextBlockButtonStyle}">
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="{Binding Category}" Margin="3,-7,10,10"
                                                       Style="{StaticResource SubheaderTextBlockStyle}"
                                                       TextWrapping="NoWrap" />
                                                </StackPanel>
                                            </Button>
                                        </Grid>
                                    </DataTemplate>
                                </GroupStyle.HeaderTemplate>
                            </GroupStyle>
                        </GridView.GroupStyle>
                    </GridView>
                </Grid>
            </Grid>
            <StackPanel Background="#FFC5C5C5" HorizontalAlignment="Right" Grid.Column="1">
                <AppBarButton x:Name="PostButton" Click="PostButton_Click" Label="Post">
                    <AppBarButton.Icon>
                        <PathIcon Data="M11.3351049423218,24.214527130127L10,30.0000019073486 15.4701061248779,28.7376861572266 13.9979677200317,25.9081382751465 12.8458433151245,24.8685665130615 11.3351049423218,24.214527130127z M20.5263156890869,27.8947372436523L36.5399513244629,11.8811063766479 34.2997360229492,8.38645458221436 31.3512115478516,5.49089479446411 16.3157901763916,20.5263156890869 16.3157901763916,23.684211730957 20.5263156890869,23.684211730957 20.5263156890869,27.8947372436523z M15.2631587982178,20L30.4413166046143,4.82184219360352 28.1188945770264,3.46003699302673 12.6315793991089,18.9473686218262 12.6315793991089,20 15.2631587982178,20z"/>
                    </AppBarButton.Icon>
                </AppBarButton>
                <AppBarButton x:Name="SimilesButton" Click="SimilesButton_Click" Label="Smilies">
                    <AppBarButton.Icon>
                        <SymbolIcon/>
                    </AppBarButton.Icon>
                </AppBarButton>
                <AppBarButton x:Name="BBcodeButton" Click="BBcodeButton_Click" Label="BBcode">
                    <AppBarButton.Icon>
                        <PathIcon Data="M15.7894744873047,26.8421058654785L10,21.0526313781738 10,19.4736843109131 15.7894744873047,13.6842107772827 15.7894744873047,16.3157901763916 12.105263710022,20 15.7894744873047,23.684211730957 15.7894744873047,26.8421058654785z M22.6315269470215,11.0526838302612L19.4736843109131,28.9473686218262 17.3684215545654,28.9473686218262 20.5263156890869,11.0526838302612 22.6315269470215,11.0526838302612z M24.2105274200439,26.8421058654785L24.2105274200439,23.684211730957 27.8947372436523,20 24.2105274200439,16.3157901763916 24.2105274200439,13.6842107772827 30.0000019073486,19.4736843109131 30.0000019073486,21.0526313781738 24.2105274200439,26.8421058654785z"/>
                    </AppBarButton.Icon>
                </AppBarButton>
                <AppBarButton x:Name="PreviewButton" Click="PreviewButton_Click" Label="Preview">
                    <AppBarButton.Icon>
                        <PathIcon Data="M23.684211730957,16.3157901763916L26.7572059631348,16.9361953735352 29.2666397094727,18.6280994415283 30.9585437774658,21.1375331878662 31.5789489746094,24.2105274200439 30.9585437774658,27.2835216522217 29.2666397094727,29.7929553985596 26.7572059631348,31.4848575592041 23.684211730957,32.1052627563477 20.6112174987793,31.4848575592041 18.1017837524414,29.7929553985596 16.4098796844482,27.2835216522217 15.7894744873047,24.2105274200439 16.4098796844482,21.1375331878662 18.1017837524414,18.6280994415283 20.6112174987793,16.9361953735352 23.684211730957,16.3157901763916z M23.684211730957,17.4436321258545L22.6768970489502,17.5181064605713 22.5563697814941,18.0075263977051 22.4594497680664,18.1749324798584 22.2039356231689,18.0780143737793 21.8426895141602,18.0868244171143 21.4285793304443,18.5714225769043 21.1906871795654,19.0648536682129 21.2171192169189,19.1353435516357 21.3492813110352,19.2058334350586 21.4285793304443,19.6992645263672 21.0520534515381,20.0044097900391 20.8463916778564,19.9632530212402 20.8646850585938,19.9812107086182 21.2876052856445,20.2984027862549 20.8646850585938,20.8270530700684 20.6884593963623,20.7477550506592 20.3007640838623,20.615592956543 19.9130687713623,20.5891609191895 19.7368431091309,20.8270530700684 19.3844032287598,21.3205070495605 18.609001159668,21.3910007476807 18.3622970581055,21.5672187805176 18.3270530700684,21.9548950195313 18.2918109893799,22.3425731658936 18.0451068878174,22.5187911987305 17.7345924377441,22.1468963623047 17.4629993438721,21.5438423156738 17.110631942749,22.5979480743408 17.3479614257813,23.0126647949219 17.5363426208496,23.6298370361328 18.0451068878174,24.7744216918945 18.379919052124,24.5365295410156 18.6090087890625,24.5629615783691 19.1729488372803,24.7744216918945 19.7015991210938,24.8449153900146 20.0187911987305,25.3383693695068 20.7236862182617,25.690803527832 21.4285793304443,26.4661598205566 22.4859085083008,27.0300807952881 22.93528175354,27.2591819763184 23.1203174591064,27.5940017700195 23.0321998596191,27.849515914917 22.8383445739746,27.9464359283447 22.6444873809814,28.1490859985352 22.5563697814941,28.7217903137207 22.4858837127686,29.2152442932129 21.9924755096436,29.285737991333 21.4774875640869,29.6831722259521 21.0680541992188,30.4531593322754 23.684211730957,30.9774227142334 26.3511066436768,30.4316463470459 28.5187377929688,28.945369720459 28.1954746246338,28.2988948822021 28.2968044281006,28.1138591766357 28.4774360656738,27.6644878387451 28.5523357391357,27.1093845367432 28.3364734649658,26.6071586608887 27.8430213928223,25.8317775726318 27.7725276947021,25.4793167114258 27.5874996185303,25.6467304229736 27.1381454467773,25.9727516174316 26.5830612182617,26.1930408477783 26.0808429718018,26.0432643890381 25.746000289917,25.787727355957 25.516902923584,25.690803527832 25.2878150939941,25.4881496429443 24.9530010223389,24.9154205322266 24.8032169342041,24.1752796173096 25.0234870910645,23.6466121673584 25.3494911193848,23.3294162750244 25.5168972015381,23.2236843109131 25.5257091522217,23.0474681854248 25.5873908996582,22.6597900390625 25.7548122406006,22.2721118927002 26.0808429718018,22.0958957672119 26.5125751495361,21.937292098999 26.9971771240234,21.6729545593262 27.5875205993652,21.6200866699219 28.3364734649658,22.0958957672119 28.7775993347168,21.8653564453125 29.9102630615234,21.5551586151123 28.7421588897705,19.7150535583496 28.3364734649658,19.8402633666992 28.1778564453125,20.0164585113525 28.3364543914795,20.4041385650635 28.4950618743896,20.7918281555176 28.3364734649658,20.9680519104004 27.772533416748,20.6861038208008 27.2086315155029,20.4041576385498 26.6447372436523,20.756591796875 26.0808429718018,21.5319499969482 25.8341159820557,21.7610530853271 25.7988700866699,21.6729431152344 25.7636241912842,21.3733596801758 25.5168972015381,20.9680519104004 25.4464168548584,20.7213478088379 25.7988700866699,20.6861038208008 26.1513214111328,20.6508617401123 26.0808429718018,20.4041576385498 25.9310359954834,20.0693225860596 26.151309967041,19.8402366638184 26.4773235321045,19.6111507415771 26.6447372436523,19.2763156890869 27.0290412902832,18.839054107666 27.6377906799316,18.718053817749 26.6447372436523,18.1485271453857 26.7857093811035,18.5626373291016 26.5037574768066,18.9238815307617 25.5168972015381,19.2763156890869 25.293436050415,18.705249786377 25.5110530853271,17.6931056976318 23.684211730957,17.4436321258545z M16.9173164367676,24.2105274200439L17.5179290771484,27.0016918182373 19.1444225311279,29.2287368774414 18.609001159668,28.1578960418701 18.2389450073242,27.9508361816406 17.9746189117432,27.4530143737793 17.7631587982178,26.3252105712891 17.699836730957,25.6962509155273 17.8013153076172,25.0942115783691 17.415641784668,24.6918563842773 17.3429012298584,24.5469150543213 17.4812107086182,24.2105274200439 17.3199405670166,23.8154678344727 16.9577903747559,23.4660015106201 16.9173164367676,24.2105274200439z M9.47368431091309,11.0526323318481L30.5263175964355,11.0526323318481 30.5263175964355,19.3002643585205 28.9473686218262,17.6364231109619 28.9473686218262,13.6842107772827 11.0526323318481,13.6842107772827 11.0526323318481,24.2105274200439 15.2631587982178,24.2105274200439 15.4109477996826,25.7894744873047 9.47368431091309,25.7894744873047 9.47368431091309,11.0526323318481z"/>
                    </AppBarButton.Icon>
                </AppBarButton>
                <AppBarButton x:Name="LastPostsButton" Click="LastPostsButton_OnClick" Label="Last Post">
                    <AppBarButton.Icon>
                        <PathIcon Data="M30.5263175964355,22.3684215545654L30.5263175964355,25.7894744873047 25.7894744873047,30.0000019073486 21.0526313781738,25.5263175964355 21.0526313781738,22.3684215545654 24.2105274200439,25.1527900695801 24.2105274200439,18.684211730957 23.7762432098389,16.5331172943115 22.5919094085693,14.7765140533447 20.8353061676025,13.5921792984009 18.684211730957,13.1578950881958 16.5331172943115,13.5921792984009 14.7765140533447,14.7765140533447 13.5921792984009,16.5331172943115 13.1578950881958,18.684211730957 13.5682468414307,20.7778129577637 14.6907634735107,22.5042381286621 16.3626346588135,23.7006893157959 18.4210529327393,24.2043685913086 18.4210529327393,27.3645267486572 15.1332426071167,26.6116199493408 12.4576187133789,24.7377433776855 10.6584491729736,22.0071811676025 10,18.684211730957 10.682448387146,15.3039245605469 12.5435466766357,12.5435466766357 15.3039245605469,10.682448387146 18.684211730957,10 22.0644989013672,10.682448387146 24.8248748779297,12.5435466766357 26.6859741210938,15.3039245605469 27.3684215545654,18.684211730957 27.3684215545654,25.1973686218262 30.5263175964355,22.3684215545654z"/>
                    </AppBarButton.Icon>
                </AppBarButton>
                <AppBarButton x:Name="ImageUploadButton" Click="ImageUploadButton_OnClick" Label="Imgur">
                    <AppBarButton.Icon>
                        <PathIcon Data="M7.89473724365234,12.105263710022L32.1052627563477,12.105263710022 32.1052627563477,27.8947372436523 7.89473724365234,27.8947372436523 7.89473724365234,12.105263710022z M9.47368431091309,13.6842107772827L9.47368431091309,26.3157901763916 30.5263175964355,26.3157901763916 30.5263175964355,13.6842107772827 9.47368431091309,13.6842107772827z M13.6842107772827,25.2631587982178L16.8859481811523,21.7543697357178 18.5526313781738,23.4210529327393 25.2193164825439,16.7543697357178 27.7193164825439,19.2543697357178 29.4736862182617,17.3684215545654 29.4736862182617,25.2631587982178 13.6842107772827,25.2631587982178z M14.7806844711304,15.7456321716309L14.5187368392944,17.0431137084961 13.8043823242188,18.1026458740234 12.7448492050171,18.8170013427734 11.4473686218262,19.0789489746094 10.5263156890869,18.9473686218262 10.5263156890869,14.7368431091309 14.5613689422607,14.7368431091309 14.7806844711304,15.7456321716309z"/>
                    </AppBarButton.Icon>
                </AppBarButton>
            </StackPanel>
        </Grid>

        <Grid Grid.Row="0" Canvas.ZIndex="99">
            <ProgressBar x:Name="loadingProgressBar" IsIndeterminate="True" Visibility="Collapsed" Width="Auto"
                         Height="10" VerticalAlignment="Top" />
        </Grid>
    </Grid>
</Page>